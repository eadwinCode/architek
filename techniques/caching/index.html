<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Ellar - Python ASGI web framework for building fast, efficient and scalable RESTAPIs and server-side application."><link href=https://github.com/python-ellar/ellar/techniques/caching/ rel=canonical><link rel=icon href=../../img/Icon.svg><meta name=generator content="mkdocs-1.4.2, mkdocs-material-8.5.10"><title>Caching -</title><link rel=stylesheet href=../../assets/stylesheets/main.975780f9.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.2505c338.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Source Sans Pro";--md-code-font:"Fira Code"}</style><link rel=stylesheet href=../../assets/_mkdocstrings.css><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=pink data-md-color-accent=pink> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#caching class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title class="md-header__button md-logo" aria-label data-md-component=logo> <img src=../../img/EllarLogoB.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Caching </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=pink data-md-color-accent=pink aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=pink data-md-color-accent=pink aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/python-ellar/ellar title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> eadwinCode/ellar </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Get Started </a> </li> <li class=md-tabs__item> <a href=../../overview/step-one/ class=md-tabs__link> Overview </a> </li> <li class=md-tabs__item> <a href=../../basics/execution-context/ class=md-tabs__link> Essentials </a> </li> <li class=md-tabs__item> <a href=../configurations/ class="md-tabs__link md-tabs__link--active"> Techniques </a> </li> <li class=md-tabs__item> <a href=../../security/authentication/ class=md-tabs__link> Security </a> </li> <li class=md-tabs__item> <a href=../../cli/introduction/ class=md-tabs__link> CLI </a> </li> <li class=md-tabs__item> <a href=../../openapi/ class=md-tabs__link> OPENAPI </a> </li> <li class=md-tabs__item> <a href=../../websockets/websockets/ class=md-tabs__link> WebSockets </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title class="md-nav__button md-logo" aria-label data-md-component=logo> <img src=../../img/EllarLogoB.png alt=logo> </a> </label> <div class=md-nav__source> <a href=https://github.com/python-ellar/ellar title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> eadwinCode/ellar </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1 type=checkbox id=__nav_1> <div class="md-nav__link md-nav__link--index "> <a href=../..>Get Started</a> <label for=__nav_1> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label="Get Started" data-md-level=1> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Get Started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../quick-project/ class=md-nav__link> Quick Setup </a> </li> <li class=md-nav__item> <a href=../../contribution/ class=md-nav__link> Contribution </a> </li> <li class=md-nav__item> <a href=../../release-notes/ class=md-nav__link> Release Notes </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2> Overview <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Overview data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Overview </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../overview/step-one/ class=md-nav__link> Step One </a> </li> <li class=md-nav__item> <a href=../../overview/controllers/ class=md-nav__link> Controllers </a> </li> <li class=md-nav__item> <a href=../../overview/providers/ class=md-nav__link> Providers </a> </li> <li class=md-nav__item> <a href=../../overview/modules/ class=md-nav__link> Modules </a> </li> <li class=md-nav__item> <a href=../../overview/middleware/ class=md-nav__link> Middlewares </a> </li> <li class=md-nav__item> <a href=../../overview/exception_handling/ class=md-nav__link> Exception Handling </a> </li> <li class=md-nav__item> <a href=../../overview/guards/ class=md-nav__link> Guards </a> </li> <li class=md-nav__item> <a href=../../overview/custom_decorators/ class=md-nav__link> Custom Decorators </a> </li> <li class=md-nav__item> <a href=../../overview/module-router/ class=md-nav__link> Module Router </a> </li> <li class=md-nav__item> <a href=../../overview/interceptors/ class=md-nav__link> Interceptors </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3> Essentials <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Essentials data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Essentials </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../basics/execution-context/ class=md-nav__link> Execution Context </a> </li> <li class=md-nav__item> <a href=../../basics/dynamic-modules/ class=md-nav__link> Dynamic Modules </a> </li> <li class=md-nav__item> <a href=../../basics/injector-scopes/ class=md-nav__link> Injector Scopes </a> </li> <li class=md-nav__item> <a href=../../basics/lifespan/ class=md-nav__link> Lifespan </a> </li> <li class=md-nav__item> <a href=../../basics/application-context/ class=md-nav__link> Application Context </a> </li> <li class=md-nav__item> <a href=../../basics/testing/ class=md-nav__link> Testing </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4 checked> <label class=md-nav__link for=__nav_4> Techniques <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Techniques data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Techniques </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../configurations/ class=md-nav__link> Configuration </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_2 type=checkbox id=__nav_4_2> <div class="md-nav__link md-nav__link--index "> <a href=../validations/ >Input Validations</a> <label for=__nav_4_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label="Input Validations" data-md-level=2> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> Input Validations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../validations/path-params/ class=md-nav__link> Path </a> </li> <li class=md-nav__item> <a href=../validations/query-params/ class=md-nav__link> Query </a> </li> <li class=md-nav__item> <a href=../validations/header-params/ class=md-nav__link> Header </a> </li> <li class=md-nav__item> <a href=../validations/cookie-params/ class=md-nav__link> Cookie </a> </li> <li class=md-nav__item> <a href=../validations/body/ class=md-nav__link> Body </a> </li> <li class=md-nav__item> <a href=../validations/form-params/ class=md-nav__link> Form </a> </li> <li class=md-nav__item> <a href=../validations/file-params/ class=md-nav__link> File </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../serializers/ class=md-nav__link> Serializers </a> </li> <li class=md-nav__item> <a href=../response-model/ class=md-nav__link> Response Model </a> </li> <li class=md-nav__item> <a href=../versioning/ class=md-nav__link> Versioning </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Caching <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Caching </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#setting-up-the-cache class=md-nav__link> Setting up the cache </a> <nav class=md-nav aria-label="Setting up the cache"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#memcached class=md-nav__link> Memcached </a> </li> <li class=md-nav__item> <a href=#redis class=md-nav__link> Redis </a> </li> <li class=md-nav__item> <a href=#local-memory-caching class=md-nav__link> Local-memory caching </a> </li> <li class=md-nav__item> <a href=#custom-cache-backend class=md-nav__link> Custom Cache Backend </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#cache-arguments class=md-nav__link> Cache Arguments </a> </li> <li class=md-nav__item> <a href=#setting-up-more-than-one-cache-backend class=md-nav__link> Setting up More than One Cache Backend </a> </li> <li class=md-nav__item> <a href=#cacheservice-icacheservice class=md-nav__link> CacheService (ICacheService) </a> </li> <li class=md-nav__item> <a href=#injecting-cacheservice class=md-nav__link> Injecting CacheService </a> </li> <li class=md-nav__item> <a href=#using-cache-decorator class=md-nav__link> Using Cache Decorator </a> <nav class=md-nav aria-label="Using Cache Decorator"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#adding-custom-key-gen-function-for-cache-decorator class=md-nav__link> Adding Custom key gen function for cache Decorator </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_7 type=checkbox id=__nav_4_7> <label class=md-nav__link for=__nav_4_7> Templating <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Templating data-md-level=2> <label class=md-nav__title for=__nav_4_7> <span class="md-nav__icon md-icon"></span> Templating </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../templating/ class=md-nav__link> Html </a> </li> <li class=md-nav__item> <a href=../staticfiles/ class=md-nav__link> Static Files </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../mount/ class=md-nav__link> Mount </a> </li> <li class=md-nav__item> <a href=../background-task/ class=md-nav__link> Background Tasks </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5 type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5> Security <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Security data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Security </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../security/authentication/ class=md-nav__link> Authentication </a> </li> <li class=md-nav__item> <a href=../../security/authorization/ class=md-nav__link> Authorization </a> </li> <li class=md-nav__item> <a href=../../security/encryption_and_hashing/ class=md-nav__link> Encryption and Hashing </a> </li> <li class=md-nav__item> <a href=../../security/csrf/ class=md-nav__link> CSRF and CORS </a> </li> <li class=md-nav__item> <a href=../../security/sessions/ class=md-nav__link> Sessions </a> </li> <li class=md-nav__item> <a href=../../security/throttling/ class=md-nav__link> Rate Limiting </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6 type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6> CLI <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=CLI data-md-level=1> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> CLI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cli/introduction/ class=md-nav__link> Introduction </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6_2 type=checkbox id=__nav_6_2> <label class=md-nav__link for=__nav_6_2> Commands <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Commands data-md-level=2> <label class=md-nav__title for=__nav_6_2> <span class="md-nav__icon md-icon"></span> Commands </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cli/new-command/ class=md-nav__link> new </a> </li> <li class=md-nav__item> <a href=../../cli/create-project-command/ class=md-nav__link> create project </a> </li> <li class=md-nav__item> <a href=../../cli/create-module-command/ class=md-nav__link> create module </a> </li> <li class=md-nav__item> <a href=../../cli/runserver-command/ class=md-nav__link> runserver </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../cli/custom-commands/ class=md-nav__link> Custom Commands </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_7 type=checkbox id=__nav_7> <div class="md-nav__link md-nav__link--index "> <a href=../../openapi/ >OPENAPI</a> <label for=__nav_7> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=OPENAPI data-md-level=1> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> OPENAPI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../openapi/security/ class=md-nav__link> Security </a> </li> <li class=md-nav__item> <a href=../../openapi/documentation-ui.md class=md-nav__link> Document UI </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_8 type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8> WebSockets <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=WebSockets data-md-level=1> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> WebSockets </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../websockets/websockets/ class=md-nav__link> index </a> </li> <li class=md-nav__item> <a href=../../websockets/socketio/ class=md-nav__link> Socketio </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#setting-up-the-cache class=md-nav__link> Setting up the cache </a> <nav class=md-nav aria-label="Setting up the cache"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#memcached class=md-nav__link> Memcached </a> </li> <li class=md-nav__item> <a href=#redis class=md-nav__link> Redis </a> </li> <li class=md-nav__item> <a href=#local-memory-caching class=md-nav__link> Local-memory caching </a> </li> <li class=md-nav__item> <a href=#custom-cache-backend class=md-nav__link> Custom Cache Backend </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#cache-arguments class=md-nav__link> Cache Arguments </a> </li> <li class=md-nav__item> <a href=#setting-up-more-than-one-cache-backend class=md-nav__link> Setting up More than One Cache Backend </a> </li> <li class=md-nav__item> <a href=#cacheservice-icacheservice class=md-nav__link> CacheService (ICacheService) </a> </li> <li class=md-nav__item> <a href=#injecting-cacheservice class=md-nav__link> Injecting CacheService </a> </li> <li class=md-nav__item> <a href=#using-cache-decorator class=md-nav__link> Using Cache Decorator </a> <nav class=md-nav aria-label="Using Cache Decorator"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#adding-custom-key-gen-function-for-cache-decorator class=md-nav__link> Adding Custom key gen function for cache Decorator </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/python-ellar/ellar/blob/master/docs/techniques/caching.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg> </a> <h1 id=caching><strong>Caching</strong><a class=headerlink href=#caching title="Permanent link">&para;</a></h1> <p>Caching refers to the process of storing frequently accessed data in a temporary storage area called a <code>cache</code>, in order to speed up access to that data in the future.</p> <p>In computing, caching is used to optimize the performance of applications and systems by reducing the time it takes to retrieve data from slower or more distant storage. By caching data in a faster, more local storage location, the system can quickly retrieve the data without needing to go all the way to the original source of the data.</p> <p>In Ellar, we provided several cache backends interface that interacts with different cache types to assist in cache endpoint responses or other relevant data.</p> <h2 id=setting-up-the-cache><strong>Setting up the cache</strong><a class=headerlink href=#setting-up-the-cache title="Permanent link">&para;</a></h2> <p>It's very simple to set up cache in Ellar but the crucial part is picking the cache type that is suitable for your application because some cache type behave differently and perform better and faster than others.</p> <p>To set up cache, we need to use <code>CacheModule</code>. <code>CacheModule</code> provides two methods, <code>CacheModule.register_setup</code> and <code>CacheModule.setup</code>, for setting up <code>cache</code> in ellar applications.</p> <div class="tabbed-set tabbed-alternate" data-tabs=1:2><input checked=checked id=__tabbed_1_1 name=__tabbed_1 type=radio><input id=__tabbed_1_2 name=__tabbed_1 type=radio><div class=tabbed-labels><label for=__tabbed_1_1>CacheModule Register Setup</label><label for=__tabbed_1_2>CacheModule Setup</label></div> <div class=tabbed-content> <div class=tabbed-block> <p>This setup method requires you to defined <code>CACHES</code> variable containing key value pairs of cache backends in <code>config.py</code> file.</p> <p>for example:</p> <div class=highlight><pre><span></span><code><span class=c1># project_name/config.py</span>

<span class=kn>from</span> <span class=nn>ellar.core</span> <span class=kn>import</span> <span class=n>ConfigDefaultTypesMixin</span>
<span class=kn>from</span> <span class=nn>ellar.cache.backends.local_cache</span> <span class=kn>import</span> <span class=n>LocalMemCacheBackend</span>

<span class=k>class</span> <span class=nc>DevelopmentConfig</span><span class=p>(</span><span class=n>ConfigDefaultTypesMixin</span><span class=p>):</span>
    <span class=n>CACHES</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;default&#39;</span><span class=p>:</span> <span class=n>LocalMemCacheBackend</span><span class=p>(</span><span class=n>ttl</span><span class=o>=</span><span class=mi>300</span><span class=p>,</span> <span class=n>key_prefix</span><span class=o>=</span><span class=s1>&#39;local&#39;</span><span class=p>,</span> <span class=n>version</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
    <span class=p>}</span>
</code></pre></div> <p>After that you register <code>CacheModule</code> to application modules <div class=highlight><pre><span></span><code><span class=c1># project_name/root_module.py</span>
<span class=kn>from</span> <span class=nn>ellar.cache</span> <span class=kn>import</span> <span class=n>CacheModule</span>
<span class=kn>from</span> <span class=nn>ellar.common</span> <span class=kn>import</span> <span class=n>Module</span>

<span class=nd>@Module</span><span class=p>(</span><span class=n>modules</span><span class=o>=</span><span class=p>[</span><span class=n>CacheModule</span><span class=o>.</span><span class=n>register_setup</span><span class=p>()])</span>
<span class=k>class</span> <span class=nc>ApplicationModule</span><span class=p>:</span>
    <span class=k>pass</span>
</code></pre></div> The <code>register_setup</code> will read <code>CACHES</code> from application config and setup the <code>CacheService</code> appropriately.</p> </div> <div class=tabbed-block> <p>The setup method requires direct definition of cache backend on the <code>CacheModule</code> setup function.</p> <p>for example:</p> <p><div class=highlight><pre><span></span><code><span class=c1># project_name/root_module.py</span>
<span class=kn>from</span> <span class=nn>ellar.cache</span> <span class=kn>import</span> <span class=n>CacheModule</span>
<span class=kn>from</span> <span class=nn>ellar.cache.backends.local_cache</span> <span class=kn>import</span> <span class=n>LocalMemCacheBackend</span>
<span class=kn>from</span> <span class=nn>ellar.common</span> <span class=kn>import</span> <span class=n>Module</span>

<span class=nd>@Module</span><span class=p>(</span><span class=n>modules</span><span class=o>=</span><span class=p>[</span>
    <span class=n>CacheModule</span><span class=o>.</span><span class=n>setup</span><span class=p>(</span>
        <span class=n>default</span><span class=o>=</span><span class=n>LocalMemCacheBackend</span><span class=p>(</span><span class=n>ttl</span><span class=o>=</span><span class=mi>300</span><span class=p>,</span> <span class=n>key_prefix</span><span class=o>=</span><span class=s1>&#39;default&#39;</span><span class=p>,</span> <span class=n>version</span><span class=o>=</span><span class=mi>1</span><span class=p>),</span>
        <span class=n>local</span><span class=o>=</span><span class=n>LocalMemCacheBackend</span><span class=p>(</span><span class=n>key_prefix</span><span class=o>=</span><span class=s1>&#39;local&#39;</span><span class=p>),</span>
        <span class=n>others</span><span class=o>=</span><span class=n>LocalMemCacheBackend</span><span class=p>(</span><span class=n>key_prefix</span><span class=o>=</span><span class=s1>&#39;others&#39;</span><span class=p>),</span>
    <span class=p>)</span>
<span class=p>])</span>
<span class=k>class</span> <span class=nc>ApplicationModule</span><span class=p>:</span>
    <span class=k>pass</span>
</code></pre></div> In CacheModule.<code>setup</code>, the <code>default</code> parameter must be provided and other cache backends will be defined as keyword-arguments just like <code>local</code> and <code>others</code> incase you want to set up more than one cache backend.</p> </div> </div> </div> <h3 id=memcached><strong>Memcached</strong><a class=headerlink href=#memcached title="Permanent link">&para;</a></h3> <p><a href=https://memcached.org/ target=_blank>Memcached</a> is an entirely memory-based cache server, originally developed to handle high loads at LiveJournal.com and subsequently open-sourced by Danga Interactive.</p> <p>Memcached runs as a daemon and is allotted a specified amount of RAM. All it does is provide a fast interface for adding, retrieving and deleting data in the cache. All data is stored directly in memory.</p> <p>After installing Memcached itself, you’ll need to install a Memcached binding. There are several Python Memcached bindings available; </p> <p>Ellar supports are <a href=https://pypi.org/project/pylibmc/ target=_blank>pylibmc</a> and <a href=https://pypi.org/project/pymemcache/ target=_blank>pymemcache</a></p> <p>For an example, lets assume you have a Memcached is running on localhost (127.0.0.1) port 11211, using the <code>pymemcache</code> or <code>pylibmc</code> binding:</p> <div class="tabbed-set tabbed-alternate" data-tabs=2:2><input checked=checked id=__tabbed_2_1 name=__tabbed_2 type=radio><input id=__tabbed_2_2 name=__tabbed_2 type=radio><div class=tabbed-labels><label for=__tabbed_2_1>pymemcache</label><label for=__tabbed_2_2>pylibmc</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=c1># project_name/config.py</span>

<span class=kn>from</span> <span class=nn>ellar.core</span> <span class=kn>import</span> <span class=n>ConfigDefaultTypesMixin</span>
<span class=kn>from</span> <span class=nn>ellar.cache.backends.pymem_cache</span> <span class=kn>import</span> <span class=n>PyMemcacheCacheBackend</span>

<span class=k>class</span> <span class=nc>DevelopmentConfig</span><span class=p>(</span><span class=n>ConfigDefaultTypesMixin</span><span class=p>):</span>
    <span class=n>CACHES</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;default&#39;</span><span class=p>:</span> <span class=n>PyMemcacheCacheBackend</span><span class=p>(</span><span class=n>servers</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;127.0.0.1:11211&#39;</span><span class=p>])</span>
    <span class=p>}</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=c1># project_name/config.py</span>

<span class=kn>from</span> <span class=nn>ellar.core</span> <span class=kn>import</span> <span class=n>ConfigDefaultTypesMixin</span>
<span class=kn>from</span> <span class=nn>ellar.cache.backends.pylib_cache</span> <span class=kn>import</span> <span class=n>PyLibMCCacheBackend</span>

<span class=k>class</span> <span class=nc>DevelopmentConfig</span><span class=p>(</span><span class=n>ConfigDefaultTypesMixin</span><span class=p>):</span>
    <span class=n>CACHES</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;default&#39;</span><span class=p>:</span> <span class=n>PyLibMCCacheBackend</span><span class=p>(</span><span class=n>servers</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;127.0.0.1:11211&#39;</span><span class=p>])</span>
    <span class=p>}</span>
</code></pre></div> </div> </div> </div> <p>If Memcached is available through a local Unix socket file /tmp/memcached.sock using the <code>pymemcache</code> or <code>pylibmc</code> binding:</p> <div class="tabbed-set tabbed-alternate" data-tabs=3:2><input checked=checked id=__tabbed_3_1 name=__tabbed_3 type=radio><input id=__tabbed_3_2 name=__tabbed_3 type=radio><div class=tabbed-labels><label for=__tabbed_3_1>pymemcache</label><label for=__tabbed_3_2>pylibmc</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=c1># project_name/config.py</span>

<span class=kn>from</span> <span class=nn>ellar.core</span> <span class=kn>import</span> <span class=n>ConfigDefaultTypesMixin</span>
<span class=kn>from</span> <span class=nn>ellar.cache.backends.pymem_cache</span> <span class=kn>import</span> <span class=n>PyMemcacheCacheBackend</span>

<span class=k>class</span> <span class=nc>DevelopmentConfig</span><span class=p>(</span><span class=n>ConfigDefaultTypesMixin</span><span class=p>):</span>
    <span class=n>CACHES</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;default&#39;</span><span class=p>:</span> <span class=n>PyMemcacheCacheBackend</span><span class=p>(</span><span class=n>servers</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;/tmp/memcached.sock&#39;</span><span class=p>])</span>
    <span class=p>}</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=c1># project_name/config.py</span>

<span class=kn>from</span> <span class=nn>ellar.core</span> <span class=kn>import</span> <span class=n>ConfigDefaultTypesMixin</span>
<span class=kn>from</span> <span class=nn>ellar.cache.backends.pylib_cache</span> <span class=kn>import</span> <span class=n>PyLibMCCacheBackend</span>

<span class=k>class</span> <span class=nc>DevelopmentConfig</span><span class=p>(</span><span class=n>ConfigDefaultTypesMixin</span><span class=p>):</span>
    <span class=n>CACHES</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;default&#39;</span><span class=p>:</span> <span class=n>PyLibMCCacheBackend</span><span class=p>(</span><span class=n>servers</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;/tmp/memcached.sock&#39;</span><span class=p>])</span>
    <span class=p>}</span>
</code></pre></div> </div> </div> </div> <p>if your Memcached is its ability to share a cache over multiple servers, then you can config that too Lets assume the cache is shared over Memcached instances running on IP address 172.19.26.240 and 172.19.26.242, both on port 11211 or different ports</p> <div class="tabbed-set tabbed-alternate" data-tabs=4:2><input checked=checked id=__tabbed_4_1 name=__tabbed_4 type=radio><input id=__tabbed_4_2 name=__tabbed_4 type=radio><div class=tabbed-labels><label for=__tabbed_4_1>pymemcache</label><label for=__tabbed_4_2>pylibmc</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=c1># project_name/config.py</span>

<span class=kn>from</span> <span class=nn>ellar.core</span> <span class=kn>import</span> <span class=n>ConfigDefaultTypesMixin</span>
<span class=kn>from</span> <span class=nn>ellar.cache.backends.pymem_cache</span> <span class=kn>import</span> <span class=n>PyMemcacheCacheBackend</span>

<span class=k>class</span> <span class=nc>DevelopmentConfig</span><span class=p>(</span><span class=n>ConfigDefaultTypesMixin</span><span class=p>):</span>
    <span class=n>CACHES</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;default&#39;</span><span class=p>:</span> <span class=n>PyMemcacheCacheBackend</span><span class=p>(</span><span class=n>servers</span><span class=o>=</span><span class=p>[</span>
            <span class=s1>&#39;172.19.26.240:11211&#39;</span><span class=p>,</span>
            <span class=s1>&#39;172.19.26.242:11212&#39;</span><span class=p>,</span>
            <span class=s1>&#39;172.19.26.244:11213&#39;</span><span class=p>,</span>
        <span class=p>])</span>
    <span class=p>}</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=c1># project_name/config.py</span>

<span class=kn>from</span> <span class=nn>ellar.core</span> <span class=kn>import</span> <span class=n>ConfigDefaultTypesMixin</span>
<span class=kn>from</span> <span class=nn>ellar.cache.backends.pylib_cache</span> <span class=kn>import</span> <span class=n>PyLibMCCacheBackend</span>

<span class=k>class</span> <span class=nc>DevelopmentConfig</span><span class=p>(</span><span class=n>ConfigDefaultTypesMixin</span><span class=p>):</span>
    <span class=n>CACHES</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;default&#39;</span><span class=p>:</span> <span class=n>PyLibMCCacheBackend</span><span class=p>(</span><span class=n>servers</span><span class=o>=</span><span class=p>[</span>
            <span class=s1>&#39;172.19.26.240:11211&#39;</span><span class=p>,</span>
            <span class=s1>&#39;172.19.26.242:11212&#39;</span><span class=p>,</span>
            <span class=s1>&#39;172.19.26.244:11213&#39;</span><span class=p>,</span>
        <span class=p>])</span>
    <span class=p>}</span>
</code></pre></div> </div> </div> </div> <p>For <strong>pymemcache</strong>, we provided some default configuration during initialization shown below: <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>pymemcache</span>

<span class=n>_options</span> <span class=o>=</span> <span class=p>{</span>
    <span class=s1>&#39;allow_unicode_keys&#39;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>
    <span class=s1>&#39;default_noreply&#39;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
    <span class=s1>&#39;serde&#39;</span><span class=p>:</span> <span class=n>pymemcache</span><span class=o>.</span><span class=n>serde</span><span class=o>.</span><span class=n>pickle_serde</span><span class=p>,</span>
<span class=p>}</span>
</code></pre></div></p> <p>These can be changed by setting the desired value in <code>options</code> parameter during initialization. For example:</p> <div class=highlight><pre><span></span><code><span class=c1># project_name/config.py</span>

<span class=kn>from</span> <span class=nn>ellar.core</span> <span class=kn>import</span> <span class=n>ConfigDefaultTypesMixin</span>
<span class=kn>from</span> <span class=nn>ellar.cache.backends.pymem_cache</span> <span class=kn>import</span> <span class=n>PyMemcacheCacheBackend</span>

<span class=k>class</span> <span class=nc>DevelopmentConfig</span><span class=p>(</span><span class=n>ConfigDefaultTypesMixin</span><span class=p>):</span>
    <span class=n>CACHES</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;default&#39;</span><span class=p>:</span> <span class=n>PyMemcacheCacheBackend</span><span class=p>(</span><span class=n>servers</span><span class=o>=</span><span class=p>[</span>
            <span class=s1>&#39;172.19.26.240:11211&#39;</span><span class=p>,</span>
            <span class=s1>&#39;172.19.26.242:11212&#39;</span><span class=p>,</span>
            <span class=s1>&#39;172.19.26.244:11213&#39;</span><span class=p>,</span>
        <span class=p>],</span> <span class=n>options</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;default_noreply&#39;</span><span class=p>:</span> <span class=kc>True</span><span class=p>})</span>
    <span class=p>}</span>
</code></pre></div> <h3 id=redis><strong>Redis</strong><a class=headerlink href=#redis title="Permanent link">&para;</a></h3> <p><a href=https://redis.io/ target=_blank>Redis</a> is a high-performance, in-memory database that is commonly used for caching data. To get started with Redis, you will need to have a Redis server running on either your local machine or a remote server.</p> <p>Once you have set up the Redis server, you will need to install the <a href=https://pypi.org/project/redis/ target=_blank>Redis</a> Python client library to be able to communicate with Redis from your Python code. </p> <p>To use redis in Ellar, you need to import RedisCacheBackend from <code>ellar.cache.backend.redis</code>.</p> <p>Let's assume after setting up your redis server and it's running on localhost (127.0.0.1) port 6379:</p> <div class="tabbed-set tabbed-alternate" data-tabs=5:3><input checked=checked id=__tabbed_5_1 name=__tabbed_5 type=radio><input id=__tabbed_5_2 name=__tabbed_5 type=radio><input id=__tabbed_5_3 name=__tabbed_5 type=radio><div class=tabbed-labels><label for=__tabbed_5_1>Redis</label><label for=__tabbed_5_2>Redis - with username and password</label><label for=__tabbed_5_3>Redis - multiple server</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=c1># project_name/config.py</span>

<span class=kn>from</span> <span class=nn>ellar.core</span> <span class=kn>import</span> <span class=n>ConfigDefaultTypesMixin</span>
<span class=kn>from</span> <span class=nn>ellar.cache.backends.redis</span> <span class=kn>import</span> <span class=n>RedisCacheBackend</span>

<span class=k>class</span> <span class=nc>DevelopmentConfig</span><span class=p>(</span><span class=n>ConfigDefaultTypesMixin</span><span class=p>):</span>
    <span class=n>CACHES</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;default&#39;</span><span class=p>:</span> <span class=n>RedisCacheBackend</span><span class=p>(</span><span class=n>servers</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;redis://127.0.0.1:6379&#39;</span><span class=p>])</span>
    <span class=p>}</span>
</code></pre></div> </div> <div class=tabbed-block> <p>Often Redis servers are protected with authentication. In order to supply a username and password as follows: <div class=highlight><pre><span></span><code><span class=c1># project_name/config.py</span>

<span class=kn>from</span> <span class=nn>ellar.core</span> <span class=kn>import</span> <span class=n>ConfigDefaultTypesMixin</span>
<span class=kn>from</span> <span class=nn>ellar.cache.backends.redis</span> <span class=kn>import</span> <span class=n>RedisCacheBackend</span>

<span class=k>class</span> <span class=nc>DevelopmentConfig</span><span class=p>(</span><span class=n>ConfigDefaultTypesMixin</span><span class=p>):</span>
    <span class=n>CACHES</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;default&#39;</span><span class=p>:</span> <span class=n>RedisCacheBackend</span><span class=p>(</span><span class=n>servers</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;redis://username:password@127.0.0.1:6379&#39;</span><span class=p>])</span>
    <span class=p>}</span>
</code></pre></div></p> </div> <div class=tabbed-block> <p>If you have multiple Redis servers set up in the replication mode, you can specify the servers either as a semicolon or comma delimited string, or as a list. While using multiple servers, write operations are performed on the first server (leader). Read operations are performed on the other servers (replicas) chosen at random:</p> <div class=highlight><pre><span></span><code><span class=c1># project_name/config.py</span>

<span class=kn>from</span> <span class=nn>ellar.core</span> <span class=kn>import</span> <span class=n>ConfigDefaultTypesMixin</span>
<span class=kn>from</span> <span class=nn>ellar.cache.backends.redis</span> <span class=kn>import</span> <span class=n>RedisCacheBackend</span>

<span class=k>class</span> <span class=nc>DevelopmentConfig</span><span class=p>(</span><span class=n>ConfigDefaultTypesMixin</span><span class=p>):</span>
    <span class=n>CACHES</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;default&#39;</span><span class=p>:</span> <span class=n>RedisCacheBackend</span><span class=p>(</span><span class=n>servers</span><span class=o>=</span><span class=p>[</span>
            <span class=s1>&#39;redis://127.0.0.1:6379&#39;</span><span class=p>,</span> <span class=c1># leader</span>
            <span class=s1>&#39;redis://127.0.0.1:6378&#39;</span><span class=p>,</span> <span class=c1># read-replica 1</span>
            <span class=s1>&#39;redis://127.0.0.1:6377&#39;</span><span class=p>,</span> <span class=c1># read-replica 2</span>
        <span class=p>])</span>
    <span class=p>}</span>
</code></pre></div> </div> </div> </div> <h3 id=local-memory-caching><strong>Local-memory caching</strong><a class=headerlink href=#local-memory-caching title="Permanent link">&para;</a></h3> <p>The local memory cache is the default caching mechanism used by Ellar, and it is automatically used if you do not specify a different caching backend in your config.py file. This cache stores cached data in memory, which provides fast access to cached data, and is ideal if you don't have the resources or capabilities to set up a separate caching server like Memcached. Its also thread-safe.</p> <div class="tabbed-set tabbed-alternate" data-tabs=6:1><input checked=checked id=__tabbed_6_1 name=__tabbed_6 type=radio><div class=tabbed-labels><label for=__tabbed_6_1>Local Memory Cache</label></div> <div class=tabbed-content> <div class=tabbed-block></div> </div> </div> <div class=highlight><pre><span></span><code><span class=c1># project_name/config.py</span>

<span class=kn>from</span> <span class=nn>ellar.core</span> <span class=kn>import</span> <span class=n>ConfigDefaultTypesMixin</span>
<span class=kn>from</span> <span class=nn>ellar.cache.backends.local_cache</span> <span class=kn>import</span> <span class=n>LocalMemCacheBackend</span>

<span class=k>class</span> <span class=nc>DevelopmentConfig</span><span class=p>(</span><span class=n>ConfigDefaultTypesMixin</span><span class=p>):</span>
    <span class=n>CACHES</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;default&#39;</span><span class=p>:</span> <span class=n>LocalMemCacheBackend</span><span class=p>()</span>
    <span class=p>}</span>
</code></pre></div> <h3 id=custom-cache-backend><strong>Custom Cache Backend</strong><a class=headerlink href=#custom-cache-backend title="Permanent link">&para;</a></h3> <p>You can create you own version of the cache backend. All you need is to inherit for <code>ellar.</code></p> <p>for example: <div class=highlight><pre><span></span><code><span class=c1># project_name/cache_backend.py</span>
<span class=kn>from</span> <span class=nn>ellar.cache.model</span> <span class=kn>import</span> <span class=n>BaseCacheBackend</span>

<span class=k>class</span> <span class=nc>CustomCacheBackend</span><span class=p>(</span><span class=n>BaseCacheBackend</span><span class=p>):</span>
    <span class=k>pass</span>
</code></pre></div> Then, in config.py <div class=highlight><pre><span></span><code><span class=c1># project_name/config.py</span>

<span class=kn>from</span> <span class=nn>ellar.core</span> <span class=kn>import</span> <span class=n>ConfigDefaultTypesMixin</span>
<span class=kn>from</span> <span class=nn>.cache_backend</span> <span class=kn>import</span> <span class=n>CustomCacheBackend</span>

<span class=k>class</span> <span class=nc>DevelopmentConfig</span><span class=p>(</span><span class=n>ConfigDefaultTypesMixin</span><span class=p>):</span>
    <span class=n>CACHES</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;default&#39;</span><span class=p>:</span> <span class=n>CustomCacheBackend</span><span class=p>()</span>
    <span class=p>}</span>
</code></pre></div></p> <h2 id=cache-arguments><strong>Cache Arguments</strong><a class=headerlink href=#cache-arguments title="Permanent link">&para;</a></h2> <p>You can customize the behavior of each caching backend in Django by passing additional arguments when you configure the cache. The valid arguments that can be passed to each backend are as follows:</p> <ul> <li><strong>TIMEOUT</strong>: The default timeout, in seconds, to use for the cache. This argument defaults to <strong>300</strong> seconds (5 minutes). You can set <strong>TIMEOUT</strong> to None so that, by default, cache keys never expire. A value of 0 causes keys to immediately expire</li> <li><strong>OPTIONS</strong>: Any options that should be passed to the cache backend. The list of valid options will vary with each backend.</li> <li><strong>KEY_PREFIX</strong>: A string that will be automatically prepended to all cache keys.</li> <li><strong>VERSION</strong>: The default version number for cache keys.</li> </ul> <div class=highlight><pre><span></span><code><span class=c1># project_name/config.py</span>

<span class=kn>from</span> <span class=nn>ellar.core</span> <span class=kn>import</span> <span class=n>ConfigDefaultTypesMixin</span>
<span class=kn>from</span> <span class=nn>ellar.cache.backends.pymem_cache</span> <span class=kn>import</span> <span class=n>PyMemcacheCacheBackend</span>

<span class=k>class</span> <span class=nc>DevelopmentConfig</span><span class=p>(</span><span class=n>ConfigDefaultTypesMixin</span><span class=p>):</span>
    <span class=n>CACHES</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;default&#39;</span><span class=p>:</span> <span class=n>PyMemcacheCacheBackend</span><span class=p>(</span>
            <span class=n>servers</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;127.0.0.1:11211&#39;</span><span class=p>],</span> 
            <span class=n>options</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;default_noreply&#39;</span><span class=p>:</span> <span class=kc>True</span><span class=p>},</span> 
            <span class=n>ttl</span><span class=o>=</span><span class=mi>300</span><span class=p>,</span> 
            <span class=n>version</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> 
            <span class=n>key_prefix</span><span class=o>=</span><span class=s1>&#39;project_name&#39;</span>
        <span class=p>)</span>
    <span class=p>}</span>
</code></pre></div> <h2 id=setting-up-more-than-one-cache-backend><strong>Setting up More than One Cache Backend</strong><a class=headerlink href=#setting-up-more-than-one-cache-backend title="Permanent link">&para;</a></h2> <p>To set up multiple cache backends in Django, you can add additional entries to the <code>CACHES</code> variable in your <code>config.py</code> file. The <code>default</code> cache backend is typically defined first, followed by any additional cache backends you want to configure.</p> <p>Here's an example <code>CACHES</code> setting that defines two cache backends:</p> <div class=highlight><pre><span></span><code><span class=c1># project_name/config.py</span>

<span class=kn>from</span> <span class=nn>ellar.core</span> <span class=kn>import</span> <span class=n>ConfigDefaultTypesMixin</span>
<span class=kn>from</span> <span class=nn>ellar.cache.backends.redis</span> <span class=kn>import</span> <span class=n>RedisCacheBackend</span>
<span class=kn>from</span> <span class=nn>ellar.cache.backends.local_cache</span> <span class=kn>import</span> <span class=n>LocalMemCacheBackend</span>

<span class=k>class</span> <span class=nc>DevelopmentConfig</span><span class=p>(</span><span class=n>ConfigDefaultTypesMixin</span><span class=p>):</span>
    <span class=n>CACHES</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;default&#39;</span><span class=p>:</span> <span class=n>RedisCacheBackend</span><span class=p>(</span><span class=n>servers</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;redis://127.0.0.1:6379&#39;</span><span class=p>],</span> <span class=n>key_prefix</span><span class=o>=</span><span class=s1>&#39;project_name&#39;</span><span class=p>),</span>
        <span class=s1>&#39;secondary&#39;</span><span class=p>:</span> <span class=n>LocalMemCacheBackend</span><span class=p>(</span><span class=n>ttl</span><span class=o>=</span><span class=mi>300</span><span class=p>,</span> <span class=n>key_prefix</span><span class=o>=</span><span class=s1>&#39;project_name&#39;</span><span class=p>,</span> <span class=n>version</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
    <span class=p>}</span>
</code></pre></div> <h2 id=cacheservice-icacheservice><strong>CacheService (ICacheService)</strong><a class=headerlink href=#cacheservice-icacheservice title="Permanent link">&para;</a></h2> <p>Ellar does not provide cache backends directly, but instead offers a caching service that manages all the configured cache backends in your application. The <code>CacheService</code> class serves as a wrapper for these cache backends and provides a uniform interface for interacting with them.</p> <p>The <code>CacheService</code> class can be injected into your application's code as a dependency, allowing you to use it throughout your application without the need for direct instantiation. This approach promotes a more modular and extensible design, as well as better testability of your code.</p> <p>The CacheService class provides methods like:</p> <p><strong>class</strong> <em><strong>CacheService(ICacheService)</strong></em>:</p> <ul> <li><strong>get</strong><em><strong>(key: str, version: str = None, backend: str = None)</strong></em>: gets <code>key</code> value from a specified cache backend.</li> <li><strong>get_async</strong><em><strong>(key: str, version: str = None, backend: str = None)</strong></em>: asynchronous version of <code>get</code> action</li> <li><strong>set</strong><em><strong>(key: str, value: t.Any, ttl: t.Union[float, int] = None, version: str = None,backend: str = None)</strong></em>: sets value to a key to a specified cache backend.</li> <li><strong>set_async</strong><em><strong>(key: str, value: t.Any, ttl: t.Union[float, int] = None, version: str = None,backend: str = None)</strong></em>: asynchronous version of <code>set</code> action</li> <li><strong>delete</strong><em><strong>(key: str, version: str = None, backend: str = None)</strong></em>: deletes a key from a specified cache backend.</li> <li><strong>delete_async</strong><em><strong>(key: str, version: str = None, backend: str = None)</strong></em>: asynchronous version of <code>delete</code> action</li> <li><strong>has_key</strong><em><strong>(key: str, version: str = None, backend: str = None)</strong></em>: checks if a key exist in a specified backend</li> <li><strong>has_key_async</strong><em><strong>(key: str, version: str = None, backend: str = None)</strong></em>: asynchronous version of <code>has_key</code> action</li> <li><strong>touch</strong><em><strong>(key: str, ttl: t.Union[float, int] = None, version: str = None, backend: str = None)</strong></em>: sets a new expiration for a key</li> <li><strong>touch_async</strong><em><strong>(key: str, ttl: t.Union[float, int] = None, version: str = None, backend: str = None)</strong></em>: asynchronous version of <code>touch</code> action</li> <li><strong>incr</strong><em><strong>(key: str, delta: int = 1, version: str = None, backend: str = None)</strong></em>: increments a value for a key by delta</li> <li><strong>incr_async</strong><em><strong>(key: str, delta: int = 1, version: str = None, backend: str = None)</strong></em>: asynchronous version of <code>incr</code> action</li> <li><strong>decr</strong><em><strong>(key: str, delta: int = 1, version: str = None, backend: str = None)</strong></em>: decrement a value for a key by delta</li> <li><strong>decr_async</strong><em><strong>(key: str, delta: int = 1, version: str = None, backend: str = None)</strong></em>: asynchronous version of <code>decr</code> action</li> </ul> <div class="admonition note"> <p class=admonition-title>Note</p> <p>If <code>backend=None</code>, <code>default</code> backend configuration is used.</p> </div> <p>These methods are available for each of the configured cache backends and can be used interchangeably with any backend.</p> <h2 id=injecting-cacheservice><strong>Injecting CacheService</strong><a class=headerlink href=#injecting-cacheservice title="Permanent link">&para;</a></h2> <p><code>CacheService</code> is a core service registered in <code>EllarInjector</code> and can be injected as every other service.</p> <p>For example, lets make <code>CacheService</code> available in our route function.</p> <div class="tabbed-set tabbed-alternate" data-tabs=7:2><input checked=checked id=__tabbed_7_1 name=__tabbed_7 type=radio><input id=__tabbed_7_2 name=__tabbed_7 type=radio><div class=tabbed-labels><label for=__tabbed_7_1>Synchronous Route Function</label><label for=__tabbed_7_2>Asynchronous Route Function</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>ellar.common</span> <span class=kn>import</span> <span class=n>get</span><span class=p>,</span> <span class=n>Inject</span>
<span class=kn>from</span> <span class=nn>ellar.cache</span> <span class=kn>import</span> <span class=n>ICacheService</span>

<span class=o>...</span>
<span class=nd>@get</span><span class=p>(</span><span class=s1>&#39;/cache-test&#39;</span><span class=p>)</span>
<span class=k>def</span> <span class=nf>my_route_function</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>cache_service</span><span class=p>:</span> <span class=n>Inject</span><span class=p>[</span><span class=n>ICacheService</span><span class=p>]):</span>
    <span class=n>cached_value</span> <span class=o>=</span> <span class=n>cache_service</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;my-key&quot;</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>cached_value</span><span class=p>:</span>
        <span class=k>return</span> <span class=n>cached_value</span>
    <span class=n>processed_value</span> <span class=o>=</span> <span class=s1>&#39;some-value&#39;</span>
    <span class=n>cache_service</span><span class=o>.</span><span class=n>set</span><span class=p>(</span><span class=s1>&#39;my-key&#39;</span><span class=p>,</span> <span class=n>processed_value</span><span class=p>,</span> <span class=n>timeout</span><span class=o>=</span><span class=mi>300</span><span class=p>)</span> <span class=c1># for 5mins</span>
    <span class=k>return</span> <span class=n>processed_value</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>ellar.common</span> <span class=kn>import</span> <span class=n>get</span><span class=p>,</span> <span class=n>Inject</span>
<span class=kn>from</span> <span class=nn>ellar.cache</span> <span class=kn>import</span> <span class=n>ICacheService</span>

<span class=o>...</span>
<span class=nd>@get</span><span class=p>(</span><span class=s1>&#39;/cache-test&#39;</span><span class=p>)</span>
<span class=k>async</span> <span class=k>def</span> <span class=nf>my_route_function</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>cache_service</span><span class=p>:</span> <span class=n>Inject</span><span class=p>[</span><span class=n>ICacheService</span><span class=p>]):</span>
    <span class=n>cached_value</span> <span class=o>=</span> <span class=k>await</span> <span class=n>cache_service</span><span class=o>.</span><span class=n>get_async</span><span class=p>(</span><span class=s2>&quot;my-key&quot;</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>cached_value</span><span class=p>:</span>
        <span class=k>return</span> <span class=n>cached_value</span>
    <span class=n>processed_value</span> <span class=o>=</span> <span class=s1>&#39;some-value&#39;</span>
    <span class=k>await</span> <span class=n>cache_service</span><span class=o>.</span><span class=n>set_async</span><span class=p>(</span><span class=s1>&#39;my-key&#39;</span><span class=p>,</span> <span class=n>processed_value</span><span class=p>,</span> <span class=n>timeout</span><span class=o>=</span><span class=mi>300</span><span class=p>)</span> <span class=c1># for 5mins</span>
    <span class=k>return</span> <span class=n>processed_value</span>
</code></pre></div> </div> </div> </div> <h2 id=using-cache-decorator><strong>Using Cache Decorator</strong><a class=headerlink href=#using-cache-decorator title="Permanent link">&para;</a></h2> <p>Ellar provides a cache decorator that can be used to cache the responses of route functions. The cache decorator can be applied to a route function to automatically cache its response data for a specified amount of time.</p> <p>The cache decorator takes the following arguments:</p> <ul> <li><code>ttl</code>(time to live): the amount of time (in seconds) for which the response data should be cached.</li> <li><code>key_prefix</code> (optional): a string that is used to prefix the cache key, allowing for easy differentiation between different cache items.</li> <li><code>version</code> (optional): a string that is used to version the cache key, allowing for cache invalidation when the data schema changes.</li> <li><code>backend</code> (optional): the name of the cache backend to use for storing the cached data. By default, the <code>default</code> cache backend is used.</li> <li><code>make_key_callback</code> (optional): a callback function that can be used to generate a custom cache key. This function takes an <code>IExecutionContext</code> instance (which contains information about the request context) and key prefix, and should return the custom cache key to use.</li> </ul> <div class="admonition info"> <p class=admonition-title>Info</p> <p><code>Cache</code> Decorator can also be applied to any controller class. When this is done, all the routes response of that controller will be cached</p> </div> <p>We can rewrite the above example using <code>cache</code> decorator:</p> <div class="tabbed-set tabbed-alternate" data-tabs=8:2><input checked=checked id=__tabbed_8_1 name=__tabbed_8 type=radio><input id=__tabbed_8_2 name=__tabbed_8 type=radio><div class=tabbed-labels><label for=__tabbed_8_1>Synchronous Route Function</label><label for=__tabbed_8_2>Asynchronous Route Function</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>ellar.common</span> <span class=kn>import</span> <span class=n>get</span>
<span class=kn>from</span> <span class=nn>ellar.cache</span> <span class=kn>import</span> <span class=n>Cache</span>
<span class=o>...</span>
<span class=nd>@get</span><span class=p>(</span><span class=s1>&#39;/cache-test&#39;</span><span class=p>)</span>
<span class=nd>@Cache</span><span class=p>(</span><span class=n>ttl</span><span class=o>=</span><span class=mi>300</span><span class=p>,</span> <span class=n>version</span><span class=o>=</span><span class=s1>&#39;v1&#39;</span><span class=p>,</span> <span class=n>key_prefix</span><span class=o>=</span><span class=s1>&#39;project_name&#39;</span><span class=p>)</span>
<span class=k>def</span> <span class=nf>my_route_function</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
    <span class=n>processed_value</span> <span class=o>=</span> <span class=s1>&#39;some-value&#39;</span>
    <span class=k>return</span> <span class=n>processed_value</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>ellar.common</span> <span class=kn>import</span> <span class=n>get</span>
<span class=kn>from</span> <span class=nn>ellar.cache</span> <span class=kn>import</span> <span class=n>Cache</span>

<span class=o>...</span>
<span class=nd>@get</span><span class=p>(</span><span class=s1>&#39;/cache-test&#39;</span><span class=p>)</span>
<span class=nd>@Cache</span><span class=p>(</span><span class=n>ttl</span><span class=o>=</span><span class=mi>300</span><span class=p>,</span> <span class=n>version</span><span class=o>=</span><span class=s1>&#39;v1&#39;</span><span class=p>,</span> <span class=n>key_prefix</span><span class=o>=</span><span class=s1>&#39;project_name&#39;</span><span class=p>)</span>
<span class=k>async</span> <span class=k>def</span> <span class=nf>my_route_function</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
    <span class=n>processed_value</span> <span class=o>=</span> <span class=s1>&#39;some-value&#39;</span>
    <span class=k>return</span> <span class=n>processed_value</span>
</code></pre></div> </div> </div> </div> <h3 id=adding-custom-key-gen-function-for-cache-decorator><strong>Adding Custom key gen function for cache Decorator</strong><a class=headerlink href=#adding-custom-key-gen-function-for-cache-decorator title="Permanent link">&para;</a></h3> <p>By default, the <code>cache</code> decorator combines the route function's URL and the specified <code>key_prefix</code> value to generate the cache key used to store the response data. However, you can customize this behavior by providing a <code>make_key_callback</code> function to the cache decorator.</p> <p>The <code>make_key_callback</code> function takes an <code>ExecutionContext</code> instance (which contains information about the request context) and the <code>key_prefix</code> value as input, and should return the custom cache key to use.</p> <p>Here's an example of how to use a custom <code>make_key_callback</code> function with the cache decorator:</p> <div class="tabbed-set tabbed-alternate" data-tabs=9:2><input checked=checked id=__tabbed_9_1 name=__tabbed_9 type=radio><input id=__tabbed_9_2 name=__tabbed_9 type=radio><div class=tabbed-labels><label for=__tabbed_9_1>Synchronous Route Function</label><label for=__tabbed_9_2>Asynchronous Route Function</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>ellar.common</span> <span class=kn>import</span> <span class=n>get</span>
<span class=kn>from</span> <span class=nn>ellar.cache</span> <span class=kn>import</span> <span class=n>Cache</span>
<span class=kn>from</span> <span class=nn>ellar.core</span> <span class=kn>import</span> <span class=n>ExecutionContext</span>
<span class=kn>from</span> <span class=nn>ellar.common.helper</span> <span class=kn>import</span> <span class=n>get_name</span>

<span class=k>def</span> <span class=nf>make_key_function</span><span class=p>(</span><span class=n>ctx</span><span class=p>:</span> <span class=n>ExecutionContext</span><span class=p>,</span> <span class=n>key_prefix</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
    <span class=n>function_name</span> <span class=o>=</span> <span class=n>get_name</span><span class=p>(</span><span class=n>ctx</span><span class=o>.</span><span class=n>get_handler</span><span class=p>())</span>
    <span class=k>return</span> <span class=s2>&quot;</span><span class=si>%s</span><span class=s2>:</span><span class=si>%s</span><span class=s2>:</span><span class=si>%s</span><span class=s2>&quot;</span> <span class=o>%</span> <span class=p>(</span><span class=n>function_name</span><span class=p>,</span> <span class=n>key_prefix</span><span class=p>,</span> <span class=n>ctx</span><span class=o>.</span><span class=n>switch_to_http_connection</span><span class=p>()</span><span class=o>.</span><span class=n>get_client</span><span class=p>()</span><span class=o>.</span><span class=n>url</span><span class=p>)</span>

<span class=o>...</span>
<span class=nd>@get</span><span class=p>(</span><span class=s2>&quot;/my_endpoint&quot;</span><span class=p>)</span>
<span class=nd>@Cache</span><span class=p>(</span><span class=n>ttl</span><span class=o>=</span><span class=mi>60</span><span class=p>,</span> <span class=n>make_key_callback</span><span class=o>=</span><span class=n>make_key_function</span><span class=p>)</span>
<span class=k>def</span> <span class=nf>my_endpoint</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
    <span class=c1># Code to generate response data here</span>
    <span class=n>processed_value</span> <span class=o>=</span> <span class=s1>&#39;some-value&#39;</span>
    <span class=k>return</span> <span class=n>processed_value</span>
<span class=o>...</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>ellar.common</span> <span class=kn>import</span> <span class=n>get</span>
<span class=kn>from</span> <span class=nn>ellar.cache</span> <span class=kn>import</span> <span class=n>Cache</span>
<span class=kn>from</span> <span class=nn>ellar.core</span> <span class=kn>import</span> <span class=n>ExecutionContext</span>
<span class=kn>from</span> <span class=nn>ellar.common.helper</span> <span class=kn>import</span> <span class=n>get_name</span>

<span class=k>def</span> <span class=nf>make_key_function</span><span class=p>(</span><span class=n>ctx</span><span class=p>:</span> <span class=n>ExecutionContext</span><span class=p>,</span> <span class=n>key_prefix</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
    <span class=n>function_name</span> <span class=o>=</span> <span class=n>get_name</span><span class=p>(</span><span class=n>ctx</span><span class=o>.</span><span class=n>get_handler</span><span class=p>())</span>
    <span class=k>return</span> <span class=s2>&quot;</span><span class=si>%s</span><span class=s2>:</span><span class=si>%s</span><span class=s2>:</span><span class=si>%s</span><span class=s2>&quot;</span> <span class=o>%</span> <span class=p>(</span><span class=n>function_name</span><span class=p>,</span> <span class=n>key_prefix</span><span class=p>,</span> <span class=n>ctx</span><span class=o>.</span><span class=n>switch_to_http_connection</span><span class=p>()</span><span class=o>.</span><span class=n>get_client</span><span class=p>()</span><span class=o>.</span><span class=n>url</span><span class=p>)</span>

<span class=o>...</span>
<span class=nd>@get</span><span class=p>(</span><span class=s2>&quot;/my_endpoint&quot;</span><span class=p>)</span>
<span class=nd>@Cache</span><span class=p>(</span><span class=n>ttl</span><span class=o>=</span><span class=mi>60</span><span class=p>,</span> <span class=n>make_key_callback</span><span class=o>=</span><span class=n>make_key_function</span><span class=p>)</span>
<span class=k>async</span> <span class=k>def</span> <span class=nf>my_endpoint</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
    <span class=c1># Code to generate response data here</span>
    <span class=n>processed_value</span> <span class=o>=</span> <span class=s1>&#39;some-value&#39;</span>
    <span class=k>return</span> <span class=n>processed_value</span>
<span class=o>...</span>
</code></pre></div> </div> </div> </div> <p>In this example, the <code>cache</code> decorator is applied to the <code>my_endpoint</code> route function, with a custom <code>make_key_callback</code> function specified. </p> <p>The <code>make_key_callback</code> function uses the <code>get_name</code> helper function to extract the name of the route function, and combines it with the <code>key_prefix</code> value and the request URL to generate the cache key.</p> <hr> <div class=md-source-file> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">October 13, 2023</span> </small> </div> </article> </div> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../versioning/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Versioning" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Versioning </div> </div> </a> <a href=../templating/ class="md-footer__link md-footer__link--next" aria-label="Next: Html" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Html </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2024 <a href=https://github.com/eadwinCode target=_blank rel=noopener>Eadwin Ezeudoh</a> </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tooltips", "search.highlight", "search.share", "search.suggest", "toc.follow", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.prune", "navigation.tabs", "navigation.left", "navigation.tracking"], "search": "../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src=../../assets/javascripts/bundle.5a2dcb6a.min.js></script> </body> </html>